# cve-import

A tool to import CVE records to a database from json files. CVE JSON files are fetched from [CVEProject/cvelistV5](https://github.com/CVEProject/cvelistV5).

## Setup

- Clone the repo and install packages with `yarn`
- Copy `.env.sample` to `.env`, and enter your Postgres credentials.
- Run `yarn migrate` to apply the prisma schema to you database.
- Clone [cvelistV5](https://github.com/CVEProject/cvelist) into an adjacent folder of cve-import (`../cvelistV5` relative to this README).

## Updating database schema

- Run `npx prisma migrate dev`
- Check status with `npx prisma migrate status`

## Writing to database

To build the database from scratch, when there is no pre-existing data, run:

```bash
yarn populate
```

To update a pre-existing database with new data, run:

```bash
yarn update
```

## Generating types

Install [json-schema-to-typescript](https://www.npmjs.com/package/json-schema-to-typescript)

```
npm install -g json-schema-to-typescript
```

Then run

```bash
./scripts/generate-types.sh
```
